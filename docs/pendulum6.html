<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pendulum with Moving Graph</title>
  <style>
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      height: 100vh;
      margin: 0;
      background-color: #f0f0f0;
    }
    canvas {
      border: 1px solid #ccc;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <canvas id="pendulumCanvas" width="400" height="300"></canvas>
  <canvas id="graphCanvas" width="400" height="150"></canvas>

  <script>
    const pendulumCanvas = document.getElementById("pendulumCanvas");
    const pendulumCtx = pendulumCanvas.getContext("2d");

    const graphCanvas = document.getElementById("graphCanvas");
    const graphCtx = graphCanvas.getContext("2d");

    const originX = pendulumCanvas.width / 2;
    const originY = 50;
    const pendulumLength = 150;
    const bobRadius = 20;
    const pendulumPeriod = 5000; // Pendulum period in milliseconds (5 seconds)
    const vectorPeriod = 10000; // Vector period in milliseconds (10 seconds)

    // Start time for continuous smooth motion
    const startTime = Date.now();

    // Array to store past coordinates of the red vector for plotting
    const graphData = [];
    const maxDataPoints = graphCanvas.width; // Width of the graph canvas in pixels

    function drawPendulum(angle, vectorAngle) {
      pendulumCtx.clearRect(0, 0, pendulumCanvas.width, pendulumCanvas.height);

      // Calculate pendulum bob position
      const bobX = originX + pendulumLength * Math.sin(angle);
      const bobY = originY + pendulumLength * Math.cos(angle);

      // Draw pendulum arm
      pendulumCtx.beginPath();
      pendulumCtx.moveTo(originX, originY);
      pendulumCtx.lineTo(bobX, bobY);
      pendulumCtx.strokeStyle = "#333";
      pendulumCtx.lineWidth = 2;
      pendulumCtx.stroke();

      // Draw pendulum bob
      pendulumCtx.beginPath();
      pendulumCtx.arc(bobX, bobY, bobRadius, 0, Math.PI * 2);
      pendulumCtx.fillStyle = "#007bff";
      pendulumCtx.fill();
      pendulumCtx.strokeStyle = "#333";
      pendulumCtx.stroke();

      // Calculate and draw rotating vector from the center of the pendulum bob
      const vectorLength = 50;
      const vectorX = bobX + vectorLength * Math.cos(vectorAngle);
      const vectorY = bobY + vectorLength * Math.sin(vectorAngle);
      pendulumCtx.beginPath();
      pendulumCtx.moveTo(bobX, bobY);
      pendulumCtx.lineTo(vectorX, vectorY);
      pendulumCtx.strokeStyle = "red";
      pendulumCtx.lineWidth = 2;
      pendulumCtx.stroke();

      // Store the x and y coordinates of the vector's endpoint for plotting
      graphData.push({ x: vectorX, y: vectorY });

      // Keep only the latest data points to match the width of the graph canvas
      if (graphData.length > maxDataPoints) {
        graphData.shift();
      }
    }

    function drawGraph() {
      graphCtx.clearRect(0, 0, graphCanvas.width, graphCanvas.height);

      // Plot x-coordinate over time in blue
      graphCtx.beginPath();
      graphCtx.strokeStyle = "blue";
      for (let i = 1; i < graphData.length; i++) {
        const x1 = i - 1;
        const y1 = graphCanvas.height / 2 - (graphData[i - 1].x - originX) / 2;
        const x2 = i;
        const y2 = graphCanvas.height / 2 - (graphData[i].x - originX) / 2;
        graphCtx.moveTo(x1, y1);
        graphCtx.lineTo(x2, y2);
      }
      graphCtx.stroke();

      // Plot y-coordinate over time in green
      graphCtx.beginPath();
      graphCtx.strokeStyle = "green";
      for (let i = 1; i < graphData.length; i++) {
        const x1 = i - 1;
        const y1 = graphCanvas.height / 2 - (graphData[i - 1].y - originY) / 2;
        const x2 = i;
        const y2 = graphCanvas.height / 2 - (graphData[i].y - originY) / 2;
        graphCtx.moveTo(x1, y1);
        graphCtx.lineTo(x2, y2);
      }
      graphCtx.stroke();
    }

    function animatePendulum() {
      const elapsedTime = Date.now() - startTime;

      // Calculate angles for pendulum swing and rotating vector
      const pendulumAngle = Math.sin((elapsedTime / pendulumPeriod) * 2 * Math.PI) * Math.PI / 6;
      const vectorAngle = (elapsedTime / vectorPeriod) * 2 * Math.PI;

      drawPendulum(pendulumAngle, vectorAngle);
      drawGraph();

      requestAnimationFrame(animatePendulum);
    }

    animatePendulum();
  </script>
</body>
</html>

